<?xml version="1.0"?>
<mx:Application
    xmlns:mx="http://www.adobe.com/2006/mxml"
    xmlns:game="tetris.*"
    creationComplete="init()">

    <mx:Script>
        <![CDATA[

        import tetris.Board;
        import tetris.Tetris;
        import tetris.TetrisEvent;

        import flash.events.Event;

        [Bindable]
        private var score:int = 0;

        private function init():void {
            new Tetris(gameCanvas);
            gameCanvas.width = Board.WIDTH * Board.BLOCK_SIZE;
            gameCanvas.height = Board.HEIGHT * Board.BLOCK_SIZE;

            addEventListener(TetrisEvent.LINES_DESTROYED, awardPoints);
            addEventListener(TetrisEvent.NEW_GAME, newGameHandler);
        }

        private function awardPoints(event:TetrisEvent):void {
            score += 100 * event.destroyedLinesCount;
        }

        private function newGameHandler(event:TetrisEvent):void {
            score = 0;
        }

        private function dispatchNewGame():void {
            gameCanvas.getChildAt(0).dispatchEvent(
                    new TetrisEvent(TetrisEvent.NEW_GAME));
        }

        ]]>
    </mx:Script>

    <mx:Panel title="Tetris"
        layout="vertical"
        paddingTop="10" paddingBottom="10" paddingLeft="10" paddingRight="10">

        <mx:Button label="Nowa gra" click="dispatchNewGame()" />

        <mx:HBox>
            <mx:Label text="{score}" />
            <mx:Label text="punktÃ³w" />
        </mx:HBox>

        <game:GameCanvas id="gameCanvas" />

    </mx:Panel>

</mx:Application>
